{% extends './Finance_master.html' %}
{% import '../template/tags_macro.html' as tag %}

{%block style%}
    {{super()}}
    <!-- Bootstrap Core CSS -->
    {{tag.style('/bootstrap/dist/css/bootstrap.min.css')}}
    {{tag.style('/plugins/bower_components/bootstrap-extension/css/bootstrap-extension.css')}}
    {{tag.style('/plugins/bower_components/datatables/jquery.dataTables.min.css')}}
    {{tag.style('/plugins/bower_components/nestable/nestable.css')}}
    {{tag.style('https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.min.css')}}
    {{tag.style('https://cdnjs.cloudflare.com/ajax/libs/nestable2/1.5.0/jquery.nestable.min.CSS')}}

    <!-- Menu CSS -->
    {{tag.style('/plugins/bower_components/sidebar-nav/dist/sidebar-nav.min.css')}}
    <!-- animation CSS -->
    {{tag.style('/css/animate.css')}}
    <!--alerts CSS -->
    {{tag.style('https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.9.1/sweetalert2.min.css')}}
    <!-- Custom CSS -->
    {{tag.style('/plugins/bower_components/custom-select/custom-select.css')}}
    {{tag.style('/plugins/bower_components/bootstrap-select/bootstrap-select.min.css')}}
    {{tag.style('/css/style.css')}}
    {{tag.style('/css/custom.css')}}
    <!-- color CSS -->
    {{tag.style('/css/colors/default.css', id='theme')}}

{%endblock%}


{%block defer_script%}
    {{super()}}
    <!-- jQuery -->
    {{tag.javascript('/plugins/bower_components/jquery/dist/jquery.min.js', true)}}
    <!-- Bootstrap Core JavaScript -->
    {{tag.javascript('/bootstrap/dist/js/tether.min.js', true)}}
    {{tag.javascript('/bootstrap/dist/js/bootstrap.min.js', true)}}
    {{tag.javascript('/plugins/bower_components/bootstrap-extension/js/bootstrap-extension.min.js', true)}}
    <!-- Menu Plugin JavaScript -->
    {{tag.javascript('/plugins/bower_components/sidebar-nav/dist/sidebar-nav.min.js', true)}}
    <!--slimscroll JavaScript -->
    {{tag.javascript('/js/jquery.slimscroll.js', true)}}
    <!--Wave Effects -->
    {{tag.javascript('/js/waves.js', true)}}
    <!-- Custom Theme JavaScript -->
    {{tag.javascript('/js/custom.min.js', true)}}
    {{tag.javascript('/js/cbpFWTabs.js', true)}}
    <!-- tabs-->
    {{tag.javascript('/plugins/bower_components/datatables/jquery.dataTables.min.js', true)}}
    <!-- Sweet-Alert  -->

    <!--Style Switcher -->
    {{tag.javascript('/plugins/bower_components/styleswitcher/jQuery.style.switcher.js', true)}}

    {{tag.javascript('https://cdn.datatables.net/buttons/1.2.2/js/dataTables.buttons.min.js', true)}}
    {{tag.javascript('https://cdn.datatables.net/buttons/1.2.2/js/buttons.flash.min.js', true)}}
    {{tag.javascript('https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js', true)}}
    {{tag.javascript('https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/pdfmake.min.js', true)}}
    {{tag.javascript('https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/vfs_fonts.js', true)}}
    {{tag.javascript('https://cdn.datatables.net/buttons/1.2.2/js/buttons.html5.min.js', true)}}
    {{tag.javascript('https://cdn.datatables.net/buttons/1.2.2/js/buttons.print.min.js', true)}}
    {{tag.javascript('https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.9.1/sweetalert2.min.js', true)}}
    {{tag.javascript('https://cdnjs.cloudflare.com/ajax/libs/nestable2/1.5.0/jquery.nestable.min.js', true)}}
    {{tag.javascript('/plugins/bower_components/custom-select/custom-select.min.js', true)}}
    {{tag.javascript('/plugins/bower_components/bootstrap-select/bootstrap-select.min.js', true)}}

    <!-- Page Scripts -->
    {{tag.javascript('/js/system/AJAX_CSRF.js', true)}}
    {{tag.javascript('/js/Fin/evaluateTransaction.js', true)}}
    <!-- /Page Scripts -->

    <!-- Sweet-Alert  -->

{%endblock%}

{%block content%}

{% if transactionType ==0 %}

    <form action="/transaction/approveDirectPayment" id="form-id" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="directPaymentId" value="{{directPaymnet.id}}">
    <input type="hidden" name="transactionType" value="{{transactionType}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

    </form>

    <form action="/transaction/pendDirectPayment" id="form-id2" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="directPaymentId" value="{{directPayment.id}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

{% elif transactionType ==1 %}

    <form action="/transaction/approveCashAdvance" id="form-id" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="cashAdvanceId" value="{{cashAdvance.id}}">
    <input type="hidden" name="transactionType" value="{{transactionType}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

    </form>

    <form action="/transaction/pendCashAdvance" id="form-id2" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="cashAdvanceId" value="{{cashAdvance.id}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

{% elif transactionType ==2 %}

    <form action="/transaction/approveBookTransfer" id="form-id" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="bookTransferId" value="{{bookTransfer.id}}">
    <input type="hidden" name="transactionType" value="{{transactionType}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

    </form>

    <form action="/transaction/pendBookTransfer" id="form-id2" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="bookTransferId" value="{{bookTransfer.id}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

{% elif transactionType ==3 %}

    <form action="/transaction/approveReimbursement" id="form-id" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="reimbursementId" value="{{reimbursement.id}}">
    <input type="hidden" name="transactionType" value="{{transactionType}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

    </form>

    <form action="/transaction/pendReimbursement" id="form-id2" class="form-horizontal" method="POST">
    <input type="hidden" name="_csrf" value="{{csrfToken}}">
    <input type="hidden" name="reimbursementId" value="{{reimbursement.id}}">
    <input type="hidden" name="gosmactivity" value="{{gosmactivity}}">

{% endif %}
<div class="row">
    <!-- Left sidebar -->
    <div class="col-md-12">
        <div class="white-box">
            <div class="row">
                <div class="col-lg-2 col-md-3  col-sm-4 col-xs-12 inbox-panel">
                    <div>

                        {% if toEvaluate %}
                            <a href="#" id="approve" class="btn btn-success btn-block waves-effect waves-light ">Approve</a>
                            <a href="#" id="defer" class="btn btn-warning btn-block waves-effect waves-light ca-pend">Pend</a>
                        {% endif %}
                        <!--                       
                        <a href="#" class="btn btn-danger btn-block waves-effect waves-light ca-deny">Deny</a>
                        -->
                        
                        <div class="list-group mail-list m-t-20">
                           
                            <a href="/finance/list/transaction/{{gosmactivity}}" class="list-group-item active">Go back</a> 
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-10 col-md-9 col-sm-8 col-xs-12 mail_listing">
                    <div class="media m-b-30 p-t-20">
                        {% if transactionType == 0 %}

                            <h4 class="font-bold m-t-0">Direct Payment for {{directPayment.strategies}} to be held on {{projectproposal.startdate}}</h4> 

                            <hr>
                            <a class="pull-left" href="#"> <img class="media-object thumb-sm img-circle" src="../plugins/images/users/pawandeep.jpg" alt=""> </a>
                            <div class="media-body"> <span class="media-meta pull-right">{{directPayment.submittime}}</span>
                                <h4 class="text-danger m-0">{{directPayment.organization}} &nbsp;({{directPayment.orgid}})</h4>
                                
                                <span class="media-meta pull-right">{{directPayment.submissiondate}}</span>

                        {% elif transactionType == 1%}

                            <h4 class="font-bold m-t-0">Cash Advance for {{cashAdvance.strategies}} to be held on {{projectproposal.startdate}}</h4> 

                            <hr>
                            <a class="pull-left" href="#"> <img class="media-object thumb-sm img-circle" src="../plugins/images/users/pawandeep.jpg" alt=""> </a>
                            <div class="media-body"> <span class="media-meta pull-right">{{cashAdvance.submittime}}</span>
                                <h4 class="text-danger m-0">{{cashAdvance.organization}} &nbsp;({{cashAdvance.orgid}})</h4>
                                
                                <span class="media-meta pull-right">{{cashAdvance.submissiondate}}</span>
                        
                        {% elif transactionType == 2 %}

                             <h4 class="font-bold m-t-0">Book Transfer for {{bookTransfer.strategies}} to be held on {{projectproposal.startdate}}</h4> 

                            <hr>
                            <a class="pull-left" href="#"> <img class="media-object thumb-sm img-circle" src="../plugins/images/users/pawandeep.jpg" alt=""> </a>
                            <div class="media-body"> <span class="media-meta pull-right">{{bookTransfer.submittime}}</span>
                                <h4 class="text-danger m-0">{{bookTransfer.organization}} &nbsp;({{bookTransfer.orgid}})</h4>
                                
                                <span class="media-meta pull-right">{{bookTransfer.submissiondate}}</span>

                        {% elif transactionType == 3 %}

                            <h4 class="font-bold m-t-0">Reimbursement for {{reimbursement.strategies}} to be held on {{projectproposal.startdate}}</h4> 

                            <hr>
                            <a class="pull-left" href="#"> <img class="media-object thumb-sm img-circle" src="../plugins/images/users/pawandeep.jpg" alt=""> </a>
                            <div class="media-body"> <span class="media-meta pull-right">{{reimbursement.submittime}}</span>
                                <h4 class="text-danger m-0">{{reimbursement.organization}} &nbsp;({{reimbursement.orgid}})</h4>
                                
                                <span class="media-meta pull-right">{{reimbursement.submissiondate}}</span>

                        {% endif %}
                        
                            <small>Payable to: Dominique Dagunton (114256432), VP Finance</small>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <h3 class="box-title m-t-40">Payment Requisition Slip</h3>
                        <hr>
                       
                        <div class="col-md-12" id="" style="display: block;">
                            <div class="row">
                                <div class="col-md-6">
                                    <label style="">Local No:&nbsp;744</label>
                                    
                                </div>
                                <div class="col-md-6">
                                    <label style="">Thru:&nbsp;Mr. Sofronio G. Lingatong Jr.</label>
                                    
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12" id="" style="display: block;">
                            <div class="row">
                                <div class="col-md-6">
                                    <label style="">To:&nbsp;Accounting Office</label>
                                    
                                </div>
                                <div class="col-md-6">
        
                                {% if transactionType == 0 %}

                                    <label style="">From: {{directPayment.firstname}} {{directPayment.lastname}}</label>
                                
                                {% elif transactionType == 1 %}

                                    <label style="">From: {{cashAdvance.firstname}} {{cashAdvance.lastname}}</label>

                                {% elif transactionType == 2 %}

                                    <label style="">From: {{bookTransfer.firstname}} {{bookTransfer.lastname}}</label>

                                {% elif transactionType == 3 %}

                                    <label style="">From: {{reimbursement.firstname}} {{reimbursement.lastname}}</label>


                                {% endif %}    
                                </div>
                            </div>
                        </div>
                    
                    </div>
                    <br>
                    <br>
                    <div class="col-sm-12">

                        {% if transactionType == 0 %}

                            <h3 class="box-title m-t-40">Direct Payment Memo</h3>


                        {% elif transactionType == 1 %}
    
                            <h3 class="box-title m-t-40">Cash Advance Memo</h3>

                        {% elif transactionType == 2 %}
    
                            <h3 class="box-title m-t-40">Book Transfer Memo</h3>

                        {% elif transactionType == 3 %}
    
                            <h3 class="box-title m-t-40">Reimbursement Memo</h3>

                        {% endif %}


                        <hr>
                        <br>
                        <table id="memoTable" class="table table-bordered m-b-0">
                            <thead>
                                <tr>
                                    <th>Particulars</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody id="memo_body">

                            {% set totalamount = 0 | float %}

                            {% for particular in particulars %}

                                {% set amount = (particular.amount | round(2)) %}

                                {% set totalamount = (totalamount | float) + (amount | round(2)) %}

                                <tr><td>{{particular.material}}</td><td>Php {{particular.amount}}</td></tr>

                            {% endfor %}

                            

                            <tr><th class="text-right">Total Expense:</th><th>Php {{totalamount | round(2)}}</th></tr></tbody>
                            <tfoot>
                            </tfoot>
                        </table>
                        <br>
                        <div class="col-md-12" id="" style="display: block;">
                            <div class="col-md-12 m-b-10">


                            {% if transactionType == 0 %}

                                <label style="">Justification:</label>
                                <p>{{directPayment.justification}}</p>  


                            {% elif transactionType == 1 %}

                                <label style="">Justification for not using Direct Payment:</label>
                                <p>{{cashAdvance.justification}}</p>  


                            {% endif %}

                            </div>


                            <!-- <div class="col-md-12 m-b-10">
                                <label style="">Purpose:</label>
                                <p>{{cashAdvance.purpose}}</p>  
                            </div> -->
                        

                        </div>
                        <div class="col-md-12" id="justification_cp" style="display: none;">
                            <div class="col-md-6 m-b-10">
                                <label style="">Justification for using Cash Prize</label>    
                            </div>
                            <div class="col-md-6 m-b-10">
                                <textarea name="dp-memo" style="width: 100%"></textarea>
                            </div>
                        </div>
                    </div>
                    <h4> <i class="fa fa-paperclip m-r-10 m-b-10"></i> Attachments <span>(1)</span> </h4>
                    <div class="row">
                        <div class="col-md-12">
                            <label>Informal Quotation: </label>
                            <a href="#"><p>Sample informal quotation.pdf</p></a>
                        </div>
                         
                    </div>
                    <hr>
                    
                </div>
            </div>
        </div>
    </div>
</div>
</form>
{%endblock%}
